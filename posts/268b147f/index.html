<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>MySQL数据库语言 | 乐天的博客</title><meta name="description" content="说明：包含MySQL的四种语言：DDL、DCL、DML、DQL"><meta name="keywords" content="数据库,MySQL"><meta name="author" content="wounded-hearts"><meta name="copyright" content="wounded-hearts"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://wounded-hearts.github.io/posts/268b147f/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta property="og:type" content="article"><meta property="og:title" content="MySQL数据库语言"><meta property="og:url" content="https://wounded-hearts.github.io/posts/268b147f/"><meta property="og:site_name" content="乐天的博客"><meta property="og:description" content="说明：包含MySQL的四种语言：DDL、DCL、DML、DQL"><meta property="og:image" content="https://gitee.com/wlet/blog_images/raw/master/博客文章Logo/20200918133055.png"><meta property="article:published_time" content="2020-09-19T05:27:59.000Z"><meta property="article:modified_time" content="2020-09-18T05:34:49.975Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="prev" title="IP地址详解" href="https://wounded-hearts.github.io/posts/9f29db36/"><link rel="next" title="MariaDB的安装与使用" href="https://wounded-hearts.github.io/posts/3ff124f4/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: {"text":"❤变强❤,❤变强❤,❤我要变强❤,❤努力❤,❤努力❤,❤我要努力❤,❤学习❤,❤学习❤,❤我要学习❤,❤奋斗❤,❤奋斗❤,❤我要奋斗❤,❤加油❤,❤加油❤,❤我要加油❤","fontSize":"20px"},
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true,
  postUpdate: '2020-09-18 13:34:49'
}</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.1"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/dd.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">70</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">85</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">10</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/images/"><i class="fa-fw fas fa-images"></i><span> 图库</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/message/"><i class="fa-fw fas fa-comment-dots"></i><span> 留言板</span></a></div></div></div></div><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL四大“数据库”"><span class="toc-number">1.</span> <span class="toc-text">MySQL四大“数据库”</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL常用数据类型"><span class="toc-number">2.</span> <span class="toc-text">MySQL常用数据类型</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL常用函数"><span class="toc-number">3.</span> <span class="toc-text">MySQL常用函数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SQLyog执行并查看结果"><span class="toc-number">4.</span> <span class="toc-text">SQLyog执行并查看结果</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL数据库语言"><span class="toc-number">5.</span> <span class="toc-text">MySQL数据库语言</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL注释符"><span class="toc-number">5.1.</span> <span class="toc-text">MySQL注释符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DDL：数据定义语言"><span class="toc-number">5.2.</span> <span class="toc-text">DDL：数据定义语言</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#增"><span class="toc-number">5.2.1.</span> <span class="toc-text">增</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#删"><span class="toc-number">5.2.2.</span> <span class="toc-text">删</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#改"><span class="toc-number">5.2.3.</span> <span class="toc-text">改</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查"><span class="toc-number">5.2.4.</span> <span class="toc-text">查</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DCL：数据控制语言"><span class="toc-number">5.3.</span> <span class="toc-text">DCL：数据控制语言</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#用户管理"><span class="toc-number">5.3.1.</span> <span class="toc-text">用户管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#权限设置"><span class="toc-number">5.3.2.</span> <span class="toc-text">权限设置</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DML：数据操作语言"><span class="toc-number">5.4.</span> <span class="toc-text">DML：数据操作语言</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#增-1"><span class="toc-number">5.4.1.</span> <span class="toc-text">增</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#删-1"><span class="toc-number">5.4.2.</span> <span class="toc-text">删</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#改-1"><span class="toc-number">5.4.3.</span> <span class="toc-text">改</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DQL：数据查询语言"><span class="toc-number">5.5.</span> <span class="toc-text">DQL：数据查询语言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#单表查询"><span class="toc-number">5.6.</span> <span class="toc-text">单表查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#连表查询"><span class="toc-number">5.7.</span> <span class="toc-text">连表查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#多表查询"><span class="toc-number">5.8.</span> <span class="toc-text">多表查询</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#数据库备份"><span class="toc-number">6.</span> <span class="toc-text">数据库备份</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL方言（limit）"><span class="toc-number">7.</span> <span class="toc-text">MySQL方言（limit）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL视图（view）"><span class="toc-number">8.</span> <span class="toc-text">MySQL视图（view）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#数据库索引（index）"><span class="toc-number">9.</span> <span class="toc-text">数据库索引（index）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#数据库的存储过程"><span class="toc-number">10.</span> <span class="toc-text">数据库的存储过程</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#触发器"><span class="toc-number">11.</span> <span class="toc-text">触发器</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#事务"><span class="toc-number">12.</span> <span class="toc-text">事务</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#数据库性能优化"><span class="toc-number">13.</span> <span class="toc-text">数据库性能优化</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#执行计划"><span class="toc-number">13.1.</span> <span class="toc-text">执行计划</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#查询性能较好"><span class="toc-number">13.2.</span> <span class="toc-text">查询性能较好</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#查询性能较差"><span class="toc-number">13.3.</span> <span class="toc-text">查询性能较差</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Python3操作MySQL数据库"><span class="toc-number">14.</span> <span class="toc-text">Python3操作MySQL数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#连接数据库，并添加数据"><span class="toc-number">14.1.</span> <span class="toc-text">连接数据库，并添加数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#删除数据"><span class="toc-number">14.2.</span> <span class="toc-text">删除数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#修改-更新数据"><span class="toc-number">14.3.</span> <span class="toc-text">修改 &#x2F; 更新数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#查询数据"><span class="toc-number">14.4.</span> <span class="toc-text">查询数据</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://gitee.com/wlet/blog_images/raw/master/博客文章Logo/20200918133055.png)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">乐天的博客</a></span><span class="pull-right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/images/"><i class="fa-fw fas fa-images"></i><span> 图库</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/message/"><i class="fa-fw fas fa-comment-dots"></i><span> 留言板</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">MySQL数据库语言</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2020-09-19 13:27:59"><i class="far fa-calendar-alt fa-fw"></i> 发表于 2020-09-19</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-09-18 13:34:49"><i class="fas fa-history fa-fw"></i> 更新于 2020-09-18</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fas fa-inbox fa-fw post-meta__icon"></i><a class="post-meta__categories" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta__icon"></i><span>字数总计:</span><span class="word-count">7.2k</span><span class="post-meta__separator">|</span><i class="far fa-clock fa-fw post-meta__icon"></i><span>阅读时长: 27 分钟</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span><i class="far fa-eye fa-fw post-meta__icon"></i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h1 id="MySQL四大“数据库”"><a href="#MySQL四大“数据库”" class="headerlink" title="MySQL四大“数据库”"></a>MySQL四大“数据库”</h1><ol>
<li><code>information_schema</code>：保存着mysql数据库的其他库的所有信息。提供数据库“元数据”的访问方式。“元数据”：关于数据的数据；例如：数据库名、表名、列名及类型、访问权限等。</li>
<li><code>performance_schema</code>：5.5版本新增的一个性能优化的引擎，默认preformance_schema功能关闭</li>
<li><code>mysql</code>：mysql的核心数据库，切记不可删除，否则连数据库都登陆不进去，里面包含账号、密码等信息。</li>
<li><code>test</code>：测试的时候创建的一个库，空的，没有实际意义，可删除。</li>
</ol>
<h1 id="MySQL常用数据类型"><a href="#MySQL常用数据类型" class="headerlink" title="MySQL常用数据类型"></a>MySQL常用数据类型</h1><ol>
<li><code>int</code>：整型</li>
<li><code>double</code>：浮点型，例如<code>double(5,2)</code> “5”代表最多5位，“2”代表必须有两位小数，即最大值为<code>999.99</code>（银行等大的单位，不能使用，会有数据丢失）</li>
<li><code>decimal</code>：浮点型，在表单“钱”方面使用该类型，因为不会出现精度缺失问题</li>
<li><code>char</code>：固定长度字符串类型：<code>char(255)</code>为“最大值”</li>
<li><code>varchar</code>：可变长度字符串类型：<code>varchar(65535)</code>为“最大值”，示例：“zhangsan、lisi”</li>
<li><code>text（clob）</code>：字符串类型：主要用于存文本类型，如：小说等电子书。<ul>
<li>很小：<code>tinytext</code> 2^8^ ~ 1B</li>
<li>小：text 2^16^-1B</li>
<li>中：mediumtext 2^24^ ~ 1B</li>
<li>大：longtext 2^32^ ~ 1B</li>
</ul>
</li>
<li><code>blod</code>：字节类型：主要用于存放视频等。<ul>
<li>很小：tinyblod 2^8^ ~ 1B </li>
<li>小：blod 2^16^ ~ 1B</li>
<li>中：mediumblod 2^24^ ~ 1B</li>
<li>大：longblod 2^32^ ~ 1B</li>
</ul>
</li>
<li><code>data</code>：日期类型，格式为：YYY-MM-DD；（年-月-日）</li>
<li><code>time</code>：时间类型，格式为：HH:MM:SS；（小时：分钟：秒）</li>
<li><code>timestamp</code>：时间戳类型：YYY-MM-DD HH:MM:SS；（年-月-日 小时：分钟：秒）</li>
</ol>
<h1 id="MySQL常用函数"><a href="#MySQL常用函数" class="headerlink" title="MySQL常用函数"></a>MySQL常用函数</h1><ol>
<li>常用普通函数：<ul>
<li><code>select version();</code>：查看MySQL当前版本</li>
<li><code>select now();</code>：查看当前日期和时间（仅限MySQL使用）</li>
<li><code>select sysdate from daul;</code>：查看当前时间（仅限Oracle使用）</li>
<li><code>select year(now());</code>：只查询年份（<code>month()</code> / <code>day()</code> / <code>hour()</code> / <code>minute()</code> / <code>second()</code>也可以单独查询）</li>
<li><code>ifnull(a,b);</code>：例如<code>ifnull(score,0);</code>表示如果分数为<code>null</code>，则赋值为<code>0</code></li>
</ul>
</li>
<li>常用聚合函数：<ul>
<li>注意事项：数据中的<code>null</code>空值是不会纳入计算的</li>
<li><code>max()</code> / <code>min()</code> / <code>count()</code>计数 / <code>sum()</code>求和 / <code>avg()</code>求平均值</li>
</ul>
</li>
<li>示例：<ul>
<li>查询数据库的个数：<code>select count(schema_name) from information_schema.schemata;</code></li>
<li>MySQL别名查询：<code>select username as aaa,password as bbb from admin order by aaa;</code>（别名查询就是重命名查询；as可省略不写）</li>
</ul>
</li>
</ol>
<h1 id="SQLyog执行并查看结果"><a href="#SQLyog执行并查看结果" class="headerlink" title="SQLyog执行并查看结果"></a>SQLyog执行并查看结果</h1><ol>
<li><p>选中要执行的代码 &gt;&gt; 点击执行按钮</p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/wlet/blog_images/raw/master/037MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%AD%E8%A8%80/20200911163553.png" alt=""></p>
</li>
<li><p>选中要执行的代码 &gt;&gt; 键盘<code>F9</code></p>
</li>
<li><p>选中要执行的代码 &gt;&gt; 鼠标右键 &gt;&gt; 执行查询</p>
</li>
</ol>
<h1 id="MySQL数据库语言"><a href="#MySQL数据库语言" class="headerlink" title="MySQL数据库语言"></a>MySQL数据库语言</h1><h2 id="MySQL注释符"><a href="#MySQL注释符" class="headerlink" title="MySQL注释符"></a>MySQL注释符</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-- 两个减号一个空格（注意两个减号后面的空格）</span><br><span class="line">-- show databases;  -- 注释代码</span><br><span class="line">show databases;  -- 注释：代码末尾的;号，在终端命令行中可用\g代替</span><br></pre></td></tr></table></figure>

<h2 id="DDL：数据定义语言"><a href="#DDL：数据定义语言" class="headerlink" title="DDL：数据定义语言"></a>DDL：数据定义语言</h2><ul>
<li>作用：用来定义数据库对象：库、表、列等</li>
</ul>
<h3 id="增"><a href="#增" class="headerlink" title="增"></a>增</h3><ol>
<li><p>创建数据库：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- 创建数据库</span><br><span class="line">create database school;  -- 创建一个数据库school，这种创建方式，后期中文格式的数据会乱码</span><br><span class="line">create database school default character set utf8;  -- 设置编码格式，可有效防止乱码（default可省略）</span><br><span class="line">-- 添加if not exists，可防止覆盖已存在的数据库</span><br><span class="line">create database if not exists school default character set utf8;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建普通数据表：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-- 创建数据表时，必须先切换到指定的数据库中</span><br><span class="line">use school;  </span><br><span class="line">-- 创建数据表students</span><br><span class="line">create table students(</span><br><span class="line">id int auto_increment comment &#39;学号&#39;,</span><br><span class="line">name varchar(10) comment &#39;姓名&#39;,</span><br><span class="line">sex char(1) not null,</span><br><span class="line">age int,</span><br><span class="line">primary key(id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</li>
<li><p>数据表中的属性：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">auto_increment  -- 自动增量（1~无穷大）</span><br><span class="line">comment &#39;编号&#39;  -- 解释说明</span><br><span class="line">not null  -- 此属性不能为空</span><br><span class="line">primary key(id)  -- 将id设为主键</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-src="https://gitee.com/wlet/blog_images/raw/master/037MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%AD%E8%A8%80/20200911160846.png" alt=""></p>
</li>
<li><p>添加列：</p>
<ul>
<li>格式：<code>alter table ... add ...;</code></li>
<li>示例：<code>alter table students add height varchar(10) comment &#39;身高&#39;;</code>（在<code>students</code>表中，添加<code>height</code>列）</li>
</ul>
</li>
<li><p>给数据表添加外键约束</p>
<ul>
<li><p>条件：必须创建两个或两个以上的数据表</p>
</li>
<li><p>示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">-- 创建教师表结构（父表）</span><br><span class="line">create table if not exists teachers(</span><br><span class="line">sid int comment &#39;老师编号&#39;,</span><br><span class="line">name varchar(10) comment &#39;姓名&#39;,</span><br><span class="line">sex char(1) not null comment &#39;性别&#39;,</span><br><span class="line">age int comment &#39;年龄&#39;,</span><br><span class="line">height varchar(6) comment &#39;身高&#39;,</span><br><span class="line">hobby varchar(15) comment &#39;爱好&#39;,</span><br><span class="line">primary key(sid)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 创建学生表结构（子表）</span><br><span class="line">create table if not exists students(</span><br><span class="line">id int comment &#39;学生学号&#39;,</span><br><span class="line">name varchar(10) comment &#39;姓名&#39;,</span><br><span class="line">sex char(1) not null comment &#39;性别&#39;,</span><br><span class="line">age int comment &#39;年龄&#39;,</span><br><span class="line">height varchar(6) comment &#39;身高&#39;,</span><br><span class="line">hobby varchar(15) comment &#39;爱好&#39;,</span><br><span class="line">sid int comment &#39;老师编号&#39;,</span><br><span class="line">primary key(id),</span><br><span class="line">foreign key(sid) references teachers(sid)  -- 创建时添加外键约束</span><br><span class="line">);</span><br><span class="line">-- 创建完成后，再给学生表添加外键约束</span><br><span class="line">alter table students add constraint name01 foreign key(sid) references teachers(sid);  -- name01:名称随意</span><br></pre></td></tr></table></figure>
</li>
<li><p>注意事项：</p>
<ol>
<li>必须先创建好一个完整的表，让它做为父表，再创建子表</li>
<li>使用外键约束和添加外键约束时，必须要开启外键约束，默认是开启状态<code>1</code>，可手动设置开关</li>
<li>必须在子表中添加外键约束，并且这个外键的属性也必须和父表中的键属性一致，即：<code>key(键)</code>和<code>表名(外键)</code>一致</li>
<li>外键必须是父表中的主键，具有唯一性质</li>
<li>拥有外键的子表，在添加数据时，必须要使用父表中存在的值（外键约束的关键所在）</li>
<li>在删除拥有外键的子表时，必须要先关闭外键约束，</li>
</ol>
</li>
</ul>
</li>
<li><p>外键约束的其他操作</p>
<ul>
<li>查询外键约束的值（状态）：<code>select @@foreign_key_checks;</code></li>
<li>关闭外键约束：<code>set foreign_key_checks=0;</code></li>
<li>开启外键约束：<code>set foreign_key_checks=1;</code></li>
</ul>
</li>
<li><p>添加唯一性约束</p>
<ul>
<li>说明：该列唯一</li>
<li>每个学生只能选择一门课程：<code>alter table students add unique(id,cid);</code></li>
</ul>
</li>
</ol>
<h3 id="删"><a href="#删" class="headerlink" title="删"></a>删</h3><ol>
<li>删除数据库：<ul>
<li>格式：<code>drop database ...;</code></li>
<li>示例：<code>drop database school;</code></li>
</ul>
</li>
<li>删除数据表：<ul>
<li>格式：<code>drop table ...;</code>或者<code>truncate table ...;</code></li>
<li>示例：<code>drop table students;</code>或者<code>truncate table students;</code></li>
</ul>
</li>
<li>删除列：<ul>
<li>格式：<code>alter table ... drop ...;</code></li>
<li>示例：<code>alter table students drop height;</code>（从<code>students</code>表中，删除<code>height</code>列）</li>
</ul>
</li>
</ol>
<h3 id="改"><a href="#改" class="headerlink" title="改"></a>改</h3><ol>
<li><p>切换数据库：<code>use mysql;</code>（切换到mysql库）</p>
</li>
<li><p>修改数据库名：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">-- 不能直接修改数据库名（因为数据库中的库与表之间联系密切）</span><br><span class="line">-- 先创建一个不存在的数据库“school01”</span><br><span class="line">create database if not exists school01 character set utf8;</span><br><span class="line">-- 使用源库</span><br><span class="line">use information_schema;</span><br><span class="line">-- 查询原库中的所有数据表</span><br><span class="line">select table-name from tables where table_schema&#x3D;&#39;school&#39;;</span><br><span class="line">-- 将school库中的students表（包括表中的所有数据），移动到school01库中，并给表重命名为students01，不重命名可阔以</span><br><span class="line">rename table school.students to school01.students01;</span><br><span class="line">-- 依次将所有数据表移动完成，即可实现修改数据库名称的目的</span><br><span class="line">-- 删除原数据库school（这时的数据库为空）</span><br><span class="line">drop database school;</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改表名称：</p>
<ul>
<li>格式：<code>alter table ... rename to ...;</code></li>
<li>示例：<code>alter table students rename to students01;</code>（修改表名<code>students</code>为<code>students01</code>）</li>
</ul>
</li>
<li><p>修改列名称：</p>
<ul>
<li>格式：<code>alter table ... change ... ...;</code></li>
<li>示例：<code>alter table students change height height01 varchar(10) comment &#39;身高&#39;;</code>（修改<code>students</code>表中的<code>height</code>列）</li>
</ul>
</li>
<li><p>只修改列的数据类型：</p>
<ul>
<li>格式：<code>alter table ... modify ...;</code></li>
<li>示例：<code>alter table students modify height int;</code></li>
</ul>
</li>
</ol>
<h3 id="查"><a href="#查" class="headerlink" title="查"></a>查</h3><ol>
<li>查看所有数据库：<code>show databases;</code></li>
<li>查看所有表：<code>show tables;</code>（先切换到指定的数据库中）</li>
</ol>
<h2 id="DCL：数据控制语言"><a href="#DCL：数据控制语言" class="headerlink" title="DCL：数据控制语言"></a>DCL：数据控制语言</h2><ul>
<li>作用：用来定义访问权限和安全级别</li>
</ul>
<h3 id="用户管理"><a href="#用户管理" class="headerlink" title="用户管理"></a>用户管理</h3><ol>
<li>创建用户：<code>create user &#39;wlet&#39;@&#39;%&#39; identified by &#39;666666&#39;;</code>（<code>%</code>表示所有人都可以访问，也代表可以在任何主机上登陆）</li>
<li>删除用户：<code>drop user &#39;wlet&#39;@&#39;%&#39;;</code></li>
</ol>
<h3 id="权限设置"><a href="#权限设置" class="headerlink" title="权限设置"></a>权限设置</h3><ol>
<li>修改用户登陆权限：<ul>
<li>只允许本机访问：<code>grant all privileges on *.* to &#39;root&#39;@&#39;localhost&#39; identified by &#39;123456&#39; with grant option;</code>（说明：授予全部权限，在所有的数据库下的所有的表，给<code>root</code>用户并且在本机<code>localhost</code>下，更改密码为<code>123456</code>）</li>
<li>只允许指定IP的服务器和本机访问：<code>grant all privileges on *.* to &#39;root&#39;@&#39;192.168.31.66&#39; identified by &#39;123456&#39; with grant option;</code>（只允许<code>192.168.31.66</code>访问）</li>
</ul>
</li>
<li>赋予其他用户权限：<ul>
<li>格式：<code>grant ... to ...;</code></li>
<li>示例：<code>grant all privileges on school.* to &#39;wlet&#39;@&#39;%&#39;;</code>（说明：赋予所有权限，在<code>school</code>库上，给<code>wlet</code>用户，<code>%</code>可任意地址登陆）</li>
</ul>
</li>
<li>刷新权限：<code>flush privilege</code></li>
<li>收回权限：<ul>
<li>格式：<code>revoke ... from ...;</code></li>
<li>示例：<code>revoke insert,delete,update on school.* from &#39;wlet&#39;@&#39;%&#39;;</code>（收回权限：包括添加、删除、更改，在<code>school</code>库上，从<code>wlet</code>用户上，可任意地址登陆）</li>
</ul>
</li>
</ol>
<h2 id="DML：数据操作语言"><a href="#DML：数据操作语言" class="headerlink" title="DML：数据操作语言"></a>DML：数据操作语言</h2><ul>
<li>作用：用来操作数据库的“数据”，通过增、删、改，对数据表进行修改</li>
</ul>
<h3 id="增-1"><a href="#增-1" class="headerlink" title="增"></a>增</h3><ol>
<li><p>通用格式：<code>insert into ... value ...</code></p>
</li>
<li><p>单行插入：<code>insert into students value(1001,&#39;张三&#39;,&#39;男&#39;,66,&#39;150&#39;);</code></p>
</li>
<li><p>多行插入（可写在一行中）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">insert into students value</span><br><span class="line">(1002,&#39;李四&#39;,&#39;女&#39;,88,&#39;180&#39;),</span><br><span class="line">(1003,&#39;王五&#39;,&#39;男&#39;,99,&#39;175&#39;),</span><br><span class="line">(1004,&#39;赵六&#39;,&#39;男&#39;,77,&#39;166&#39;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>指定插入：<code>insert into students(id,name,sex) value(1005,&#39;李华&#39;,&#39;女&#39;);</code> （注意：设置了<code>not null</code>属性的列，必须要输入数据）</p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/wlet/blog_images/raw/master/037MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%AD%E8%A8%80/20200911160943.png" alt=""></p>
</li>
</ol>
<h3 id="删-1"><a href="#删-1" class="headerlink" title="删"></a>删</h3><ol>
<li>通用格式：<code>delete from ... where ...;</code></li>
<li>删除表中的所有数据：<ul>
<li><code>delete from students;</code></li>
<li><code>truncate table students;</code>（属于<code>DDL</code>语言）</li>
</ul>
</li>
<li>删除指定的数据（有条件的删除）：<code>delete from students where age=99;</code></li>
<li>删除没有年龄的数据：<code>delete from students where age is null;</code> （数据库中的<code>0</code>是有值的，空值需要用<code>null</code>表示，<code>null</code>必须用<code>is</code>连接）</li>
<li>删除年龄大于等于80的数据：<code>delete from students where age&gt;=80;</code></li>
<li>删除年龄在60和80之间的数据：<ul>
<li><code>delete from students where age&gt;60 and age&lt;80;</code></li>
<li><code>delete from students where age between 60 and 80;</code></li>
</ul>
</li>
<li>删除年龄为66和88的数据：<ul>
<li><code>delete from students where age=66 or age=88;</code> （年龄不可能即为66又为88，所以<code>and</code>不能用）</li>
<li><code>delete from students where age in(66,88);</code> （使用<code>in()</code>将属性值一一添加进行筛选，<code>not in()</code>取反）</li>
</ul>
</li>
<li>删除所有姓”李“的数据：<code>delete from students where name like &#39;李%&#39;;</code> （）</li>
<li>删除名字为三个字符的数据：<code>delete from students where name like &#39;___&#39;;</code></li>
</ol>
<h3 id="改-1"><a href="#改-1" class="headerlink" title="改"></a>改</h3><ol>
<li>通用格式：<code>update ... set ... where ...;</code></li>
<li>所有人年龄加1岁：<code>update students set age=age+1;</code></li>
<li>年龄大于66岁的，身高减10：<code>update students set height=height-10 where age&gt;66;</code></li>
<li>把id=1003的名字，改为匿名者：<code>update students set name=&#39;匿名者&#39; where id=1003;</code></li>
<li>把id=1003的名字，改为匿名者，并且年龄加100岁：<code>update students set name=&#39;匿名者&#39;,age=age+100 where id=1003;</code>（修改的属性值为多个时，需要用<code>,</code>逗号隔开，不能用<code>and</code>连接）</li>
</ol>
<h2 id="DQL：数据查询语言"><a href="#DQL：数据查询语言" class="headerlink" title="DQL：数据查询语言"></a>DQL：数据查询语言</h2><ol>
<li>作用：用来查询表记录(数据)</li>
<li>通用查询格式：<code>select ... from ... where/order by/group by ...;</code> </li>
</ol>
<h2 id="单表查询"><a href="#单表查询" class="headerlink" title="单表查询"></a>单表查询</h2><p><img src= "/img/loading.gif" data-src="https://gitee.com/wlet/blog_images/raw/master/037MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%AD%E8%A8%80/20200914121015.png" alt=""></p>
<ol>
<li>查询表中的所有数据：<code>select * from students;</code></li>
<li>查询name列中的所有数据：<code>select name from students;</code></li>
<li>查询name列中的所有数据，并将列名重命名为”姓名“：<code>select name as &#39;姓名&#39; from students;</code></li>
<li>查询性别为女的所有数据：<code>select * from students where sex=&#39;女&#39;;</code></li>
<li>查询姓”李“的所有数据：<code>select * from students where name like &#39;李%&#39;;</code> （<code>%</code>通配符）：</li>
<li>查询姓名为三个字符的所有数据：<code>select * from students where name like &#39;___&#39;;</code> （<code>_</code>占位符）</li>
<li>查询age为空的所有数据：<code>select * from students where age is null;</code> （必须要用<code>is</code>连接）</li>
<li>查询年龄为非空的所有姓名：<code>select name from students where age is not null;</code></li>
<li>查询所有的爱好：<code>select hobby from students;</code></li>
<li>查询所有的爱好种类（数据去重）：<code>select distinct hobby from students;</code></li>
<li>查询所有的数据，并按照年龄，升序排列：<code>select * from students order by age asc;</code></li>
<li>查询所有的姓名、身高，并按照身高，降序排列：<code>select name,height from students order by height desc;</code></li>
<li>查询数据后分组并筛选（<code>group by ... having ...</code>）：<ul>
<li>查询年龄大于80岁的，所有的id和年龄，并且按照年龄升序排列</li>
<li><code>select id,age from students group by age asc having age&gt;80;</code></li>
</ul>
</li>
<li>子查询并运算：<ul>
<li>查询年龄最小的id和姓名</li>
<li><code>select id,name from students where age=(select min(age) from students);</code></li>
</ul>
</li>
</ol>
<h2 id="连表查询"><a href="#连表查询" class="headerlink" title="连表查询"></a>连表查询</h2><ol>
<li><p>注意事项：当两个表连接后，数据会差生笛卡尔积效应，必须添加限制条件，消除笛卡尔积</p>
</li>
<li><p>test01表：</p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/wlet/blog_images/raw/master/037MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%AD%E8%A8%80/20200915125822.png" alt=""></p>
</li>
<li><p>test02表：</p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/wlet/blog_images/raw/master/037MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%AD%E8%A8%80/20200915125859.png" alt=""></p>
</li>
<li><p>未消除笛卡尔积：<code>select name from test01,test02;</code></p>
</li>
<li><p>内连接查询：</p>
<ul>
<li>通用格式：<code>... inner join ... on ...;</code></li>
<li>说明：从数学的角度讲就是求两个表的<strong>交集</strong>；从笛卡尔积的角度讲就是从笛卡尔积中挑出<code>on</code>子句条件成立的记录；有<code>inner join</code>、<code>where</code>（等值连接）、<code>straight_join</code>、<code>join</code>(省略<code>inner</code>)四种写法。</li>
<li>示例：<ol>
<li><code>select name from test01 inner join test02 on test01.id=test02.id;</code></li>
<li><code>select name from test01,test02 where test01.id=test02.id;</code></li>
<li><code>select name from test01 straight_join test02 on test01.id=test02.id;</code></li>
<li><code>select name from test01 join test02 on test01.id=test02.id;</code></li>
</ol>
</li>
</ul>
</li>
<li><p>外连接查询：</p>
<ul>
<li><p>分类：<code>left outer join</code>：左外连接 / <code>right outer join</code>：右外连接 / <code>full outer join</code>：全外连接（<code>outer</code>可以省略）</p>
</li>
<li><p>通用格式：<code>... left join ... on ...;</code>、<code>... right join ... on ...;</code>、<code>... full join ... on ...;</code>（<code>MySQL</code>不支持<code>full</code>）</p>
</li>
<li><p>说明：</p>
<ol>
<li>左外连接<code>left join</code>的含义就是求两个表A表和B表的<strong>交集加左表剩下的数据</strong>；从笛卡尔积的角度讲，就是先从笛卡尔积中挑出<code>on</code>子句条件成立的记录，然后加上<strong>左表A表中剩余的记录</strong></li>
<li>右外连接同理，取<strong>交集加右表剩下的数据</strong></li>
<li>全外连接就是求两个表<strong>A和B集合的并集</strong>。从笛卡尔积的角度讲就是从笛卡尔积中挑出<code>on</code>子句条件成立的记录，然后加上左表中剩余的记录，最后加上右表中剩余的记录；另外<code>MySQL</code>不支持<code>outer join</code>，但是我们可以对外左连接和右外连接的结果做<code>union</code>操作来实现</li>
<li>对称差集数据，两个表没有共同的数据，即数据为<code>null</code></li>
</ol>
</li>
<li><p>示例：</p>
<ol>
<li><p>左外连接：<code>select name from test01 a left join test02 b on a.id=b.id;</code></p>
</li>
<li><p>右外连接：<code>select name from test01 a right join test02 b on a.id=b.id;</code></p>
</li>
<li><p>全外连接（通用）：<code>select name from test01 a full join test02 b on a.id=b.id;</code>（<code>MySQL</code>不支持此语句）</p>
</li>
<li><p>全外连接：<code>select name from test01 a left join test02 b on a.id=b.id union select name from test01 a right join test02 b on a.id=b.id;</code></p>
</li>
<li><p>对称差集：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select name,hobby from test01 a left join test02 b on a.id&#x3D;b.id where b.id is null</span><br><span class="line">union select name,hobby from test01 a right join test02 b on a.id&#x3D;b.id where a.id is null;</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ul>
</li>
<li><p>查询数据结果，并判断数据是否存在：</p>
<ul>
<li>判断关键词：<code>exists</code> / <code>not exists</code></li>
<li>说明：<code>exists</code>是将查询后的结果输出，没有结果就没有输出；<code>not exist</code>是将满足条件的数据除外，返回剩余的不满足条件的数据</li>
<li><code>exists</code>示例：<code>select * from test01 where exists(select name from test02 where name like &#39;张%&#39;);</code></li>
<li><code>not exists</code>示例：<code>select * from test01 where not exists(select name from test02 where name like &#39;张%&#39;);</code></li>
</ul>
</li>
</ol>
<h2 id="多表查询"><a href="#多表查询" class="headerlink" title="多表查询"></a>多表查询</h2><h1 id="数据库备份"><a href="#数据库备份" class="headerlink" title="数据库备份"></a>数据库备份</h1><ol>
<li>导出sql文件：<code>mysqldump -u 用户名 -p 库名 &gt; 文件名.sql</code> （终端命令）</li>
<li>导入文件：<code>source c:\\文件名.sql</code> （登录后，在终端中执行）</li>
</ol>
<h1 id="MySQL方言（limit）"><a href="#MySQL方言（limit）" class="headerlink" title="MySQL方言（limit）"></a>MySQL方言（limit）</h1><ol>
<li><p>注意事项：<code>limit</code>的用法（仅限于<code>MySQL</code>数据库）</p>
</li>
<li><p>示例：</p>
<ul>
<li><p><code>select * from table01 limit 5 offset 10;</code>（从表中查询，每页只显示5条数据，跳过前10条数据，简写同下一行）</p>
</li>
<li><p><code>select * from table01 limit 5,10;</code>（从<code>table01</code>表中查询<code>(9,15)</code>之间的数据，不包括第<code>9</code>和第<code>15</code>个数据，因为<code>MySQL</code>系统默认计数从<code>0</code>开始）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">定义： pc &#x3D; 2（表示：第二页）</span><br><span class="line">	  ps &#x3D; 7（表示：每一页显示7条数据）</span><br><span class="line">1	0	7（第1页	从id&#x3D;0开始		取7条数据）</span><br><span class="line">2	7	7（第2页	从id&#x3D;7开始		取7条数据）</span><br><span class="line">3	14	7（第3页	从id&#x3D;14开始	取7条数据）</span><br><span class="line">4	21	7（第4页	从id&#x3D;21开始	取7条数据）</span><br></pre></td></tr></table></figure>
</li>
<li><p>通式：<code>select * from table01 limit (pc-1)*ps,7;</code>（表示：查询<code>table01</code>表中的数据，在每一页中显示7组数据）</p>
</li>
<li><p>页码函数：<code>(pc-1)*ps</code> （<code>0=1-1*7</code>；<code>7=2-1*7</code>；<code>14=3-1*7</code>；<code>21=4-1*7</code>）</p>
</li>
</ul>
</li>
</ol>
<h1 id="MySQL视图（view）"><a href="#MySQL视图（view）" class="headerlink" title="MySQL视图（view）"></a>MySQL视图（view）</h1><ol>
<li><p>创建视图格式：<code>create view 视图名称 as SQL查询语句;</code></p>
</li>
<li><p>视图的作用：</p>
<ul>
<li>不创建视图 &gt;&gt; 执行完整个操作过程 &gt;&gt; 得到结果（一次性结束） &gt;&gt; 下次接着循环</li>
<li>创建视图（永久性储存） &gt;&gt; 调用视图 &gt;&gt; 得到结果 &gt;&gt; 循环查询</li>
<li>调用视图的效率，比执行完整数据库命令的效率高</li>
<li>可提高查询效率，优化数据库性能</li>
<li>通过视图，可将用户的访问权限控制在指定的属性上（列上）</li>
<li>视图属于一个虚表，查询的快照</li>
</ul>
</li>
<li><p>创建视图：<code>create view hobbys as select distinct hobby from students;</code></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/wlet/blog_images/raw/master/037MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%AD%E8%A8%80/20200916123110.png" alt=""></p>
</li>
<li><p>调用视图：<code>select * from hobbys;</code></p>
</li>
<li><p>删除视图：<code>drop view hobbys;</code></p>
</li>
</ol>
<h1 id="数据库索引（index）"><a href="#数据库索引（index）" class="headerlink" title="数据库索引（index）"></a>数据库索引（index）</h1><ol>
<li><p>创建索引格式：<code>create index 索引名称 on ...</code></p>
</li>
<li><p>作用：</p>
<ul>
<li>提高查询效率；为<code>管理员</code>查询提供方便（如同“字典”）</li>
<li>索引的创建会占用内存空间，会让增删变得更慢（因为索引要不断更新）</li>
<li>索引应该建在经常使用的筛选条件所用的属性上（列名上）</li>
</ul>
</li>
<li><p>创建单个索引：<code>create index name01 on students(name);</code> （给<code>students</code>表中的<code>name</code>列，创建一个索引）</p>
</li>
<li><p>创建多个索引：<code>create index name02 on students(id,sex,age);</code> （给<code>students</code>表中的<code>id</code>、<code>sex</code>、<code>age</code>列，创建一个索引）</p>
</li>
<li><p>查看所有的索引：<code>show index from students;</code> （查看<code>students</code>表中的所有的索引）</p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/wlet/blog_images/raw/master/037MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%AD%E8%A8%80/20200916151654.png" alt=""></p>
</li>
<li><p>删除索引：<code>drop index name01 on students;</code></p>
</li>
<li><p>索引的使用规则：</p>
<ul>
<li><code>create index my_index on students(name);</code>（创建<code>index</code>）</li>
<li><code>select id,name from students where name=&#39;&#39;;</code>（已使用<code>index</code>）</li>
<li><code>select id,name from students where name&lt;&gt;&#39;张三&#39;;</code>（未使用<code>index</code>，<code>&lt;&gt;</code>为负向条件，代表不等于）</li>
<li><code>select id,name from students where name=&#39;张%&#39;;</code>（已使用<code>index</code>，模糊查询<code>%</code>在后）</li>
<li><code>select id,name from students where name=&#39;%张&#39;;</code>（未使用<code>index</code>，<code>%</code>在前）</li>
</ul>
</li>
</ol>
<h1 id="数据库的存储过程"><a href="#数据库的存储过程" class="headerlink" title="数据库的存储过程"></a>数据库的存储过程</h1><ol>
<li><p>作用：存储过程就是具有名字的一段代码，用来完成一个特定的功能；创建的存储过程保存在数据库的数据字典中</p>
</li>
<li><p>说明：把一系列的SQL语句可以封装到一个过程中，而且可以加上分支和循环，将来通过过程的名字直接调用过程即可，因为创建过程时已经提前编译了SQL语句，所以比直接执行SQL语句性能更好</p>
</li>
<li><p>优点：</p>
<ul>
<li>将重复性很高的一些操作，封装到一个存储过程中，简化了对这些SQL的调用</li>
<li>批量处理：SQL+循环，减少流量，也就是“跑批”</li>
<li>统一接口，确保数据的安全</li>
</ul>
</li>
<li><p>存储过程的参数：</p>
<ul>
<li>说明：存储过程可以有0个或多个参数，用于存储过程的定义</li>
<li>参数类型：<ol>
<li><code>in</code>输入参数：表示调用者向过程传入值（传入值可以是<strong>字面量</strong>或变量）</li>
<li><code>out</code>输出参数：表示过程向调用者传出值(可以返回多个值)（传出值只能是变量）</li>
<li><code>inout</code>输入输出参数：既表示调用者向过程传入值，又表示过程向调用者传出值（值只能是变量）</li>
</ol>
</li>
</ul>
</li>
<li><p>通用创建格式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">delimiter $$  -- 将SQL语句的结束标记设置为$$（可任意符号）</span><br><span class="line">drop procedure if exists 存储过程名称;  -- 如果存在该名字的存储过程则删除</span><br><span class="line">create procedure 存储过程名称(参数类型 参数名1 参数名1的数据类型, 参数类型 参数名2 参数名2的数据类型, ...)</span><br><span class="line">begin  -- 代码部分开始</span><br><span class="line">    SQL语句  -- 存储过程的代码部分</span><br><span class="line">end $$  -- 代码部分结束</span><br><span class="line">delimiter ;  -- 代码部分结束后，将SQL语句的结束标记设置为默认的;分号（避免影响后续操作）</span><br></pre></td></tr></table></figure>
</li>
<li><p>调用存储过程的通用格式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">-- 调用无参数的存储过程</span><br><span class="line">call 存储过程名();</span><br><span class="line">-- 定义变量，给参数赋值（注意。定义变量必须加@符号，调用变量也是如此）</span><br><span class="line">-- 数据库可用做变量名的字符：字母、数字、下划线</span><br><span class="line">set @变量名1&#x3D;某值;</span><br><span class="line">set @变量名2&#x3D;某值;</span><br><span class="line">...</span><br><span class="line">-- 调用有参数的存储过程</span><br><span class="line">call 存储过程名(@变量名1, @变量名2, ...);</span><br><span class="line">call 存储过程名(字面量1, 字面量2, ...);</span><br><span class="line">-- 查询输出</span><br><span class="line">select @变量名</span><br><span class="line">select @变量名 from dual;</span><br></pre></td></tr></table></figure>
</li>
<li><p>school02库中的students表，如下：</p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/wlet/blog_images/raw/master/037MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%AD%E8%A8%80/20200917122325.png" alt=""></p>
</li>
<li><p>输入参数的存储过程示例（<code>in</code>）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">use school02;  -- 注意，切换数据库</span><br><span class="line">-- 输入参数的存储过程</span><br><span class="line">    -- 需求：传入一个学生id，查询该学生的所有信息</span><br><span class="line">delimiter $$</span><br><span class="line">create procedure stu_in(in in_id int)</span><br><span class="line">begin</span><br><span class="line">    -- set in_id&#x3D;1003;  -- 给参数赋值（不推荐，因为参数为固定值）</span><br><span class="line">    select * from students where id&#x3D;in_id;</span><br><span class="line">end $$</span><br><span class="line">delimiter ;</span><br><span class="line">-- 定义变量，给参数赋值</span><br><span class="line">set @in_id&#x3D;1004;  -- 可在“代码部分”定义</span><br><span class="line">-- 调用存储过程</span><br><span class="line">call stu_in(@in_id);  -- 使用变量</span><br><span class="line">call stu_in(1005);  -- 使用字面量</span><br><span class="line">-- 删除存储过程</span><br><span class="line">drop procedure stu_in;</span><br></pre></td></tr></table></figure>
</li>
<li><p>输出参数的存储过程示例（<code>out</code>）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">use school02;</span><br><span class="line">-- 输出参数的存储过程</span><br><span class="line">delimiter $$</span><br><span class="line">create procedure stu_out(out msg varchar(20))</span><br><span class="line">begin</span><br><span class="line">    select distinct hobby from students;  -- 查询语句 </span><br><span class="line">    set msg&#x3D;&#39;所有的爱好种类已查询完毕！&#39;;</span><br><span class="line">end $$</span><br><span class="line">delimiter ;</span><br><span class="line">-- 调用存储过程</span><br><span class="line">call stu_out(@a);</span><br><span class="line">-- 查询输出的结果</span><br><span class="line">select @a;</span><br><span class="line">-- 重新给参数赋值，并查询</span><br><span class="line">set @a&#x3D;&#39;再次查询，所有的爱好种类已查询完毕！&#39;;</span><br><span class="line">select @a;</span><br><span class="line">select @a from dual;  -- （dual为数据库虚表）</span><br><span class="line">-- 删除存储过程</span><br><span class="line">drop procedure stu_out;</span><br></pre></td></tr></table></figure>
</li>
<li><p>输入输出参数的存储过程示例（<code>inout</code>）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">-- 输入输出参数的存储过程</span><br><span class="line">    -- 说明：输入即为输出</span><br><span class="line">use school02;</span><br><span class="line">delimiter $$</span><br><span class="line">create procedure stu_inout(inout in_id int)</span><br><span class="line">begin</span><br><span class="line">    select * from students where id&#x3D;in_id;</span><br><span class="line">end $$</span><br><span class="line">delimiter ;</span><br><span class="line">-- 定义存储变量</span><br><span class="line">set @in_id&#x3D;1001;  -- 可在“代码部分”定义</span><br><span class="line">-- 调用存储过程</span><br><span class="line">call stu_inout(@in_id);  -- 使用变量</span><br><span class="line">select @in_id;</span><br><span class="line">-- 删除存储过程</span><br><span class="line">drop procedure stu_inout;</span><br></pre></td></tr></table></figure>
</li>
<li><p>输入输出参数混合的存储过程示例（<code>in</code>和<code>out</code>）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">-- 输入输出参数混合的存储过程</span><br><span class="line">    -- 需求：输入一个正整数，如果1，返回“星期一”，如果2，返回“星期二。。。。其他返回输入错误”</span><br><span class="line">delimiter $$</span><br><span class="line">create procedure mysql_in_out(in num int, out week01 varchar(10))</span><br><span class="line">begin</span><br><span class="line">    if num &#x3D; 0 then</span><br><span class="line">        set week01 &#x3D; &#39;星期日&#39;;</span><br><span class="line">    elseif num &#x3D; 1 then</span><br><span class="line">        set week01 &#x3D; &#39;星期一&#39;;      </span><br><span class="line">    elseif num &#x3D; 2 then</span><br><span class="line">        set week01 &#x3D; &#39;星期二&#39;;</span><br><span class="line">    elseif num &#x3D; 3 then</span><br><span class="line">        set week01 &#x3D; &#39;星期三&#39;;</span><br><span class="line">    elseif num &#x3D; 4 then</span><br><span class="line">        set week01 &#x3D; &#39;星期四&#39;;</span><br><span class="line">    elseif num &#x3D; 5 then</span><br><span class="line">        set week01 &#x3D; &#39;星期五&#39;;</span><br><span class="line">    elseif num &#x3D; 6 then</span><br><span class="line">        set week01 &#x3D; &#39;星期六&#39;;</span><br><span class="line">    else </span><br><span class="line">        set week01 &#x3D; &#39;输入错误！&#39;;</span><br><span class="line">    end if;  -- 结束if条件分支</span><br><span class="line">end $$</span><br><span class="line">delimiter ;</span><br><span class="line">-- 创建了两个参数，调用时就需要加入相对应的两个参数</span><br><span class="line">call mysql_in_out(1,@a);  -- 字面量6为输入参数，变量@a为输出参数 </span><br><span class="line">select @a;</span><br><span class="line">select @a from dual;</span><br><span class="line">drop procedure mysql_in_out;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h1 id="触发器"><a href="#触发器" class="headerlink" title="触发器"></a>触发器</h1><ul>
<li>说明：触发器在执行增删改操作时可以触发其他的级联操作，但是有可能导致“锁表”现象，实际开发中应该尽量避免使用触发器<br>表“现象，实际开发中应该尽量避免使用触发器</li>
</ul>
<h1 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h1><ol>
<li>作用：把多个增删改的操作做成不可分割的原子性操作，要么全部都做，要么全都不做</li>
<li>开启事务：<ul>
<li><code>start transaction;</code> （方式一）</li>
<li><code>begin;</code>（方式二，推荐）</li>
</ul>
</li>
<li>执行数据库操作：例如<code>delete from students;</code></li>
<li>数据撤回（回滚）：<code>rollback;</code> （事务中的所有操作，全部撤销）</li>
<li>数据提交：<code>commit;</code> （事务中的所有操作，全部生效）</li>
</ol>
<h1 id="数据库性能优化"><a href="#数据库性能优化" class="headerlink" title="数据库性能优化"></a>数据库性能优化</h1><h2 id="执行计划"><a href="#执行计划" class="headerlink" title="执行计划"></a>执行计划</h2><ol>
<li>说明：执行计划，就是<code>MySQL</code>如何执行一条<code>SQL</code>语句，包括<code>SQL</code>查询的顺序、是否使用索引、以及使用索引的信息等，一条<code>SQL</code>性能的好坏，可以通过查看执行计划很直观的看出来，执行计划提供了各种查询类型与级别，方便我们进行查看以及为作为性能分析的依据。</li>
<li>通用格式：<code>explain SQL查询语句</code></li>
<li>示例（查看查询语句的详细执行过程）<ul>
<li><code>explain select id,name from students where id=1002;</code></li>
<li><code>explain select id,name from students where name=’张三’;</code></li>
</ul>
</li>
</ol>
<h2 id="查询性能较好"><a href="#查询性能较好" class="headerlink" title="查询性能较好"></a>查询性能较好</h2><ol>
<li>正向查询性能较好</li>
<li>若查询条件为主键，则查询性能会更好，因为读取的数据较少（<code>type</code>为<code>const</code>常量）<ul>
<li><code>select id,name from students where id=1008;</code> （<code>id</code>必须设置为主键）</li>
</ul>
</li>
<li>调用存储过程</li>
<li>给查询条件的属性（列）添加索引<code>index</code><ul>
<li><code>create index name01 on students(name);</code> （给<code>students</code>表中的<code>name</code>列，创建一个索引）</li>
</ul>
</li>
</ol>
<h2 id="查询性能较差"><a href="#查询性能较差" class="headerlink" title="查询性能较差"></a>查询性能较差</h2><ol>
<li><p>反向查询性能较差</p>
</li>
<li><p>若查询条件不是唯一的，则有可能会读取全表，性能最差（<code>type</code>为<code>all</code>全部）</p>
<ul>
<li><code>select id,name from students where name=’张三’;</code>（若给<code>name</code>属性添加<code>index</code>，性能会优化）</li>
<li><code>select id,name from students where name&lt;&gt;1008;</code>（<code>MySQL</code>中<code>&lt;&gt;</code>代表不等于）</li>
</ul>
</li>
</ol>
<h1 id="Python3操作MySQL数据库"><a href="#Python3操作MySQL数据库" class="headerlink" title="Python3操作MySQL数据库"></a>Python3操作MySQL数据库</h1><h2 id="连接数据库，并添加数据"><a href="#连接数据库，并添加数据" class="headerlink" title="连接数据库，并添加数据"></a>连接数据库，并添加数据</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># 1.创建连接对象</span></span><br><span class="line">    <span class="comment"># 指定主机、端口、用户名、口令、数据库名、字符集，即可创建连接</span></span><br><span class="line">    conn = pymysql.connect(</span><br><span class="line">        host=<span class="string">'192.168.25.131'</span>, port=<span class="number">3306</span>,</span><br><span class="line">        user=<span class="string">'root'</span>, passwd=<span class="string">'123456'</span>,  <span class="comment"># passwd == password</span></span><br><span class="line">        db=<span class="string">'school02'</span>, charset=<span class="string">'utf8'</span>  <span class="comment"># db == database</span></span><br><span class="line">    )</span><br><span class="line">    <span class="comment"># print(conn) # 测试连接结果（object）</span></span><br><span class="line">    <span class="comment"># 异常处理</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 2.获得光标、游标对象 cursor（获取到数据库中的一行数据）</span></span><br><span class="line">        <span class="keyword">with</span> conn.cursor() <span class="keyword">as</span> cursor:  <span class="comment"># 连接上下文</span></span><br><span class="line">            <span class="comment"># 3.执行SQL插入语句</span></span><br><span class="line">            result = cursor.execute(</span><br><span class="line">                <span class="string">'insert into students(id,name,sex) value(1007,"王麻子","男");'</span></span><br><span class="line">            )</span><br><span class="line">            print(result)</span><br><span class="line">            <span class="comment"># 4.操作成功，提交SQL执行结果</span></span><br><span class="line">            <span class="keyword">if</span> result == <span class="number">1</span>:</span><br><span class="line">                print(<span class="string">'数据添加成功！'</span>)</span><br><span class="line">            conn.commit()  <span class="comment"># 成功后提交数据</span></span><br><span class="line">    <span class="keyword">except</span> pymysql.MySQLError <span class="keyword">as</span> error:</span><br><span class="line">        print(error)</span><br><span class="line">        <span class="comment"># 4.操作失败，执行回滚</span></span><br><span class="line">        conn.rollback()</span><br><span class="line">    <span class="comment"># 5.关闭连接，释放资源（数据库的连接数量是有限的，必须随时关闭）</span></span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        conn.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<h2 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    stuid = int(input(<span class="string">'请输入要删除数据的id号：'</span>))</span><br><span class="line">    <span class="comment"># 1.创建连接对象</span></span><br><span class="line">    <span class="comment"># 指定主机、端口、用户名、口令、数据库、字符集，即可创建连接</span></span><br><span class="line">    conn = pymysql.connect(</span><br><span class="line">        host=<span class="string">'192.168.25.131'</span>, port=<span class="number">3306</span>,</span><br><span class="line">        user=<span class="string">'root'</span>, passwd=<span class="string">'123456'</span>, <span class="comment">#passwd == password</span></span><br><span class="line">        db=<span class="string">'school02'</span>, charset=<span class="string">'utf8'</span> <span class="comment">#db == database</span></span><br><span class="line">    )</span><br><span class="line">    <span class="comment"># print(conn) # 测试连接结果（object）</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 2.获得游标对象</span></span><br><span class="line">        <span class="keyword">with</span> conn.cursor() <span class="keyword">as</span> cursor:</span><br><span class="line">            <span class="comment"># 3.执行SQL删除语句</span></span><br><span class="line">            result = cursor.execute(</span><br><span class="line">                <span class="comment"># 格式化字符串必须用tuple型，逗号隔开，里面只有一个元素，必须加逗号</span></span><br><span class="line">                <span class="comment"># 'delete from tb_student where stuid=%s',(stuid,)</span></span><br><span class="line">                <span class="comment"># 'delete from tb_student where stuid=%s'%(stuid)</span></span><br><span class="line">                <span class="string">f'delete from students where id=<span class="subst">&#123;stuid&#125;</span>'</span></span><br><span class="line">            )</span><br><span class="line">            <span class="comment"># 4.操作成功，提交SQL执行结果</span></span><br><span class="line">            <span class="keyword">if</span> result == <span class="number">1</span>:</span><br><span class="line">                print(<span class="string">'数据删除成功！'</span>)</span><br><span class="line">            conn.commit()</span><br><span class="line">    <span class="keyword">except</span> pymysql.MySQLError <span class="keyword">as</span> error:</span><br><span class="line">        print(error)</span><br><span class="line">        <span class="comment"># 4.操作失败，执行回滚</span></span><br><span class="line">        conn.rollback()</span><br><span class="line">    <span class="comment"># 5.关闭连接，释放资源（数据库的连接数是有限的，必须随时关闭）</span></span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        conn.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<h2 id="修改-更新数据"><a href="#修改-更新数据" class="headerlink" title="修改 / 更新数据"></a>修改 / 更新数据</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    stu_id = int(input(<span class="string">'请输入id号：'</span>))</span><br><span class="line">    stu_age = int(input(<span class="string">'请输入年龄：'</span>))</span><br><span class="line">    stu_height = input(<span class="string">'请输入身高：'</span>)</span><br><span class="line">    stu_hobby = input(<span class="string">'请输入爱好：'</span>)</span><br><span class="line">    <span class="comment"># 1.创建连接对象</span></span><br><span class="line">    <span class="comment"># 指定主机、端口、用户名、口令、数据库、字符集，即可创建连接</span></span><br><span class="line">    conn = pymysql.connect(</span><br><span class="line">        host=<span class="string">'192.168.25.131'</span>, port=<span class="number">3306</span>,</span><br><span class="line">        user=<span class="string">'root'</span>, passwd=<span class="string">'123456'</span>,  <span class="comment"># passwd == password</span></span><br><span class="line">        db=<span class="string">'school02'</span>, charset=<span class="string">'utf8'</span>  <span class="comment"># db == database</span></span><br><span class="line">    )</span><br><span class="line">    <span class="comment"># print(conn) # 测试连接结果（object）</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 2.获得游标对象</span></span><br><span class="line">        <span class="keyword">with</span> conn.cursor() <span class="keyword">as</span> cursor:</span><br><span class="line">            <span class="comment"># 3.执行SQL更新语句</span></span><br><span class="line">            result = cursor.execute(</span><br><span class="line">                <span class="comment"># 用字符串格式化，SQL语句错误，会直接爆出数据库错误（极度危险）</span></span><br><span class="line">                <span class="comment"># 'update tb_students set stu_birth=%s where stu_id=%s'%(stu_birth, stu_id)</span></span><br><span class="line">                <span class="comment"># 'update tb_students set stu_birth=&#123;&#125; where stu_id=&#123;&#125;'.format(stu_birth, stu_id)</span></span><br><span class="line">                <span class="comment"># 若出现：(1054, "Unknown column '跑步' in 'field list'")此报错，将跑步对应的变量加上引号即可</span></span><br><span class="line">                <span class="comment"># f'update students set age=&#123;stu_age&#125;,height=&#123;stu_height&#125;,hobby=&#123;stu_hobby&#125; where id=&#123;stu_id&#125;'</span></span><br><span class="line"></span><br><span class="line">                <span class="comment"># 安全格式输出，必须用tuple格式化，若只有一个变量，必须也用逗号隔开，如：（stu_id,）</span></span><br><span class="line">                <span class="string">'update students set age=%s,height=%s,hobby=%s where id=%s'</span>, (stu_age, stu_height, stu_hobby, stu_id)</span><br><span class="line">            )</span><br><span class="line">            print(result)</span><br><span class="line">            <span class="comment"># 对SQL语句的执行结果进行判断</span></span><br><span class="line">            <span class="keyword">if</span> result == <span class="number">1</span>:</span><br><span class="line">                print(<span class="string">'数据更新成功！'</span>)</span><br><span class="line">            <span class="keyword">elif</span> result == <span class="number">0</span>:</span><br><span class="line">                print(<span class="string">'输入的id不存在！'</span>)</span><br><span class="line">            <span class="comment"># 4.操作成功，提交SQL执行结果</span></span><br><span class="line">            conn.commit()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> pymysql.MySQLError <span class="keyword">as</span> error:</span><br><span class="line">        print(error)</span><br><span class="line">        <span class="comment"># 4.操作失败，执行回滚</span></span><br><span class="line">        conn.rollback()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 5.关闭连接，释放资源（数据库的连接数是有限的，必须随时关闭）</span></span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        conn.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<h2 id="查询数据"><a href="#查询数据" class="headerlink" title="查询数据"></a>查询数据</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># 1.创建连接对象</span></span><br><span class="line">    <span class="comment"># 指定主机、端口、用户名、口令、数据库、字符集，即可创建连接</span></span><br><span class="line">    conn = pymysql.connect(</span><br><span class="line">        host=<span class="string">'192.168.25.131'</span>, port=<span class="number">3306</span>,</span><br><span class="line">        user=<span class="string">'root'</span>, passwd=<span class="string">'123456'</span>, <span class="comment">#passwd == password</span></span><br><span class="line">        db=<span class="string">'school02'</span>, charset=<span class="string">'utf8'</span> <span class="comment">#db == database</span></span><br><span class="line">    )</span><br><span class="line">    <span class="comment"># print(conn) # 测试连接结果（object）</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 2.获得游标对象</span></span><br><span class="line">        <span class="keyword">with</span> conn.cursor() <span class="keyword">as</span> cursor01:</span><br><span class="line">            <span class="comment"># 3.执行SQL删除语句</span></span><br><span class="line">            result = cursor01.execute(</span><br><span class="line">                <span class="string">'select id,name,sex from students limit 1,4'</span></span><br><span class="line">            )</span><br><span class="line">            print(result)  <span class="comment"># 只返回查询了几条数据，不返回具体的查询结果</span></span><br><span class="line">            <span class="keyword">for</span> row <span class="keyword">in</span> cursor01.fetchall():  <span class="comment"># 用fetchall()来获取每一条查询结果</span></span><br><span class="line">                <span class="comment"># print(row)</span></span><br><span class="line">                print(<span class="string">f'学号：<span class="subst">&#123;row[<span class="number">0</span>]&#125;</span>'</span>, end=<span class="string">' '</span>*<span class="number">4</span>)</span><br><span class="line">                print(<span class="string">f'姓名：<span class="subst">&#123;row[<span class="number">1</span>]&#125;</span>'</span>, end=<span class="string">' '</span>*<span class="number">4</span>)</span><br><span class="line">                print(<span class="string">f'性别：<span class="subst">&#123;row[<span class="number">2</span>]&#125;</span>'</span>)</span><br><span class="line">    <span class="keyword">except</span> pymysql.MySQLError <span class="keyword">as</span> error:</span><br><span class="line">        print(error)</span><br><span class="line">    <span class="comment"># 5.关闭连接，释放资源（数据库的连接数是有限的，必须随时关闭）</span></span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        conn.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">wounded-hearts</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://wounded-hearts.github.io/posts/268b147f/">https://wounded-hearts.github.io/posts/268b147f/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://wounded-hearts.github.io" target="_blank">乐天的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a><a class="post-meta__tags" href="/tags/MySQL/">MySQL</a></div><div class="post_share"><div class="social-share" data-image="https://gitee.com/wlet/blog_images/raw/master/博客文章Logo/20210519132513.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><button class="reward-button" type="button"><i class="fas fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="post-qr-code__img" src="https://i.loli.net/2020/08/05/ptZkvgcoeabxSm8.png" alt="微信" onclick="window.open('https://i.loli.net/2020/08/05/ptZkvgcoeabxSm8.png')"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="post-qr-code__img" src="https://i.loli.net/2020/08/05/b1DdQvapRXl6uMA.png" alt="支付宝" onclick="window.open('https://i.loli.net/2020/08/05/b1DdQvapRXl6uMA.png')"/><div class="post-qr-code__desc">支付宝</div></li></ul></div></button></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/9f29db36/"><img class="prev-cover" data-src="https://gitee.com/wlet/blog_images/raw/master/博客文章Logo/20200927102457.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">IP地址详解</div></div></a></div><div class="next-post pull-right"><a href="/posts/3ff124f4/"><img class="next-cover" data-src="https://gitee.com/wlet/blog_images/raw/master/博客文章Logo/20200929111720.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">MariaDB的安装与使用</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/posts/3ff124f4/" title="MariaDB的安装与使用"><img class="relatedPosts_cover" data-src="https://gitee.com/wlet/blog_images/raw/master/博客文章Logo/20200929111720.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-09-10</div><div class="relatedPosts_title">MariaDB的安装与使用</div></div></a></div><div class="relatedPosts_item"><a href="/posts/100c1831/" title="Redis的安装与使用"><img class="relatedPosts_cover" data-src="https://gitee.com/wlet/blog_images/raw/master/博客文章Logo/20200907165609.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-09-07</div><div class="relatedPosts_title">Redis的安装与使用</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headling"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div class="comments-items-1" data-name="Valine"><div class="vcomment" id="vcomment"></div><script>function loadvaline () {  
  var requestSetting = function (from,set) {
    var from = from
    var setting = set.split(',').filter(function(item){
    return from.indexOf(item) > -1
    });
    setting = setting.length == 0 ? from :setting;
    return setting
  }

  var guestInfo = requestSetting(['nick','mail','link'],'nick,mail,link')
  var requiredFields = requestSetting(['nick','mail'],'nick,mail')

  function initValine () {
    window.valine = new Valine({
      el:'#vcomment',
      appId: '4oIr1DcSynB0TTabT7wc489z-gzGzoHsz',
      appKey: 'oUN4TXcidEOk3PjLVQaP6OJW',
      placeholder: '说些什么吧',
      avatar: 'monsterid',
      meta: guestInfo,
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: false,
      serverURLs: 'https://4oir1dcs.lc-cn-n1-shared.com',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      requiredFields: requiredFields
    });
  }
  loadScript('https://cdn.bootcdn.net/ajax/libs/valine/1.4.14/Valine.min.js', initValine)
}

if ('Valine' === 'Valine' || false) {
  window.addEventListener('load', loadvaline)
}
else {
  function loadOtherComment () {
    loadvaline()
  }
}</script></div></div></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By wounded-hearts</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="footer_custom_text">Hellow! Welcome to my <a href="https://wounded-hearts.github.io" target="_blank">Blog</a>!</div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font_plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font_minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script id="ribbon_piao" mobile="true" src="/js/third-party/piao.js"></script><script src="/js/third-party/activate-power-mode.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
document.body.addEventListener('input', POWERMODE);
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><script src="/js/third-party/ClickShowText.js"></script><script src="/js/search/local-search.js"></script></body></html>